{% extends 'base.html.twig' %}
{% block header %}
	{% include 'partials/_navbar.html.twig' %}
{% endblock %}
{% block title %}
	Make-Sense - Les utilisateurs
{% endblock %}
{% block body %}
	<div class="container-fluid mt-4 text-white col-8 ">
		<u>
			<h3>
				Les utilisateurs
			</h3>
		</u>
		Il y a
		{{ users.getTotalItemCount}}
		utilisateurs
		<div class="count mt-4 d-flex justify-content-end">
			<a href="{{ path('app_user_new') }}" class="fs-6 ms-2 btn btn-primary" type="button">Ajouter un utilisateur</a>
		</div>
		<div class="row mt-5 d-flex justify-content-center">
			<table class="table table-striped table-bordered bg-grey-light">
				<thead class="text-center">
					<tr class="text-dark fs-5">
						<th scope="col">Photo</th>
						<th scope="col">Date de création</th>
						<th scope="col">Date de modification
						</th>
						<th scope="col">Nom</th>
						<th scope="col">Prénom</th>
						<th scope="col">Email</th>
						<th scope="col">Domaine d'expertise</th>
						<th scope="col">Centre d'intérêt</th>
						<th scope="col">Rôle</th>
						<th scope="col">Edition</th>
					</tr>
				</thead>
				<tbody>
					{% for user in users %}
						<tr class="bg-white">
							<td>
								{% if user.poster != "" %}
									<img class="rounded-5" src="{{ vich_uploader_asset(user, 'posterFile') }}" style="height:45px; width:45px" alt="..">
								{% else %}
									<i class="fs-5 rounded-4 bg-light p-3 fa-regular fa-user"></i>
								{% endif %}
							</td>
							<td>{{user.createdAt |date("m/d/Y")}}</td>
							<td>{{user.updatedAt |date("m/d/Y")}}</td>
							<td>{{user.lastname}}</td>
							<td>{{user.firstname}}</td>
							<td>{{user.email}}</td>
							<td>
								{% for expertise in user.expertises %}
									{% if expertise.isExpert == 'true' %}
									<div class="">
										{% include 'partials/_department-card.html.twig' with { 'department' : expertise.department.name } %}
									</div>
									{% endif %}
								{% endfor %}
							</td>
							<td>
								{% for expertise in user.expertises %}
									{% if expertise.isExpert != 'true' %}
										{% include 'partials/_department-card.html.twig' with { 'department' : expertise.department.name } %}
									{% endif %}
								{% endfor %}
							</td>
							<td>
								{% if user.roles|join(', ') == 'ROLE_USER' %}
									User
								{% elseif user.roles|join(', ') != 'ROLE_USER' %}
									Admin
								{% endif %}
							</td>
							<td>
								<a href="{{ path('app_user_edit', { id: user.id}) }}" class="fs-6 ms-2 btn btn-primary" type="button">Modifier</a>
							</td>
						</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
		<div class="navigation d-flex justify-content-center mt-4">
			{{ knp_pagination_render(users) }}
		</div>
	</div>
{% endblock %}
